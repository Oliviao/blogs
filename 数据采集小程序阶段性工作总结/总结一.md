1、如果需要在每个页面的onShow执行一段相同的代码，有什么最简洁的实现办法？

mozzy里面提供的 mixin 可以将一段代码进行全局混入

2、小程序加载后，需要在页面展示之前就准备好一系列数据，方便页面展示的时候直接使用。应该怎么做？

（1）使用回调。onLaunch 的时候开始请求数据，成功后调用一个函数，这个函数在onLoad里面实现，并设置一个全局标志ready=true。在页面onLoad里面如果ready=true，就调用函数获取数据，准备渲染页面。这样给人的感觉就是，onLaunch执行完之后，才会执行onLoad。在这里可以引入事件广播，使代码逻辑更清晰一些。

（2）使用mozzy.async()。和上边方法达到的效果相同，巨大的优点在于极大简化了实现方式，而且易于上手。mozzy.async()实现原理：对Page做一次包装，篡改它的生命周期，混入准备数据的一段代码，不干扰其他生命周期和函数的执行。值得一提的是，也可以通过相同的办法来实现小程序的一些埋点需求。

3、小程序setData单次设置的数据不能超过1024kb。如果遇到了超过1024kb的设置，该怎么处理？

（1）什么情况下可能出现单次超过1024kb的情况？对于常见的列表页，上拉刷新的时候需要重新渲染页面，通常我们通过 list: list.concat(res.data) 将后端刚返回的数据拼接到原有数据上，触发页面的渲染。所以，每次上拉刷新，每次setData的数据量就会越来越大，大到一定程度的时候，超过了1024kb，页面就会崩溃，怎么办？

（2）解决办法：官网上有这样一句话“其中 key 可以以数据路径的形式给出，支持改变数组中的某一项或对象的某个属性”。所以再次可以引入二维数组，每次从后端获取到新数据之后，只需要setData数组的某一项即可，用这个二维数组渲染页面，神奇的脑回路。。。

4、在正常的开发测试都通过的情况下，某一天有更多的人想看小程序，所以自己生成了一个体验版二维码，给大家共享。然鹅，同一时间收到多人反馈体验版二维码打开小程序显示“页面不存在”。开始心急火燎的排查问题，但是都显示没问题啊，本地开发者工具打开小程序显示也没问题啊，百度也搜不到原因，怎么办？

看了一眼目录，em,,,，直觉告诉自己，是不是小程序首页的文件名字不规范。然后把首页的文件名改成了“index”，果然解决了这个问题。但是导致这一现象的原因至今不明，，

5、数据上报页布局问题

<img src="images.png" >

如图，设计页面是这样的。要求：“确认上报”按钮吸附在底部，隐藏要求，备注里面用组件<textarea>。这个怎么实现？

（1）步骤一，<button>确认上报</button>，使用position:fixed固定在页面底部。可以达到排版的效果，但是面临一个问题：点击“确认上报”按钮的时候，获取点击事件的不是这个button，而是下面的textarea。原因：textarea是原生组件，而button不是，textarea就会浮于button上层，自然button捕捉不到点击事件。那好，那可以用<view>等其他一下组件来代替button啊，只可惜这些组件都不是原生组件，无法覆盖在textarea组件上方，当然设置z-index也是无效的。

小程序官网上有对原生组件这样一段解释：



（2）步骤二，使用原生组件<cover-view>代替button，<cover-view>确认上报</cover-view>，这样“确认上报”这个按钮就可以覆盖在备注里面的<textarea>组件之上了。但是确又出现了一个问题，使用position:fixed 无效了，这个按钮不能固定在页面底部了。官网上给出了这样的解释



（3）接下来怎么办呢，找官网里面找到这样一句话：



既然最外层的<cover-view>支持position:fixed，那就可以单独把上报按钮这个按钮抽取成组件，最外层使用<covew-view>，然后使用position:fixed置与页面底部就能达到最终的效果了。这也是该项目里最终选定的方案。

 

想到的其他一些办法：

（1）方案1，整个页面分为两部分，确认上报按钮使用<button>fixed到页面底部，上边部分使用position:absolute固定到上边，下边bottom:按钮的高度。正常情况下就足以解决整个布局问题和层级显示问题了。但是，备注里面的<text-area>确不能随着整个页面的上半部分进行滚动了，这是<text-area>组件的一个bug,官网上给出了解决方案，设置fixed=true。这样就可以了

（2）方案2，整个页面分为两部分，上半部分给一个固定值，包含页面除了“上报按钮”意外以外的所有元素，下半部分使用<button>按钮将上报按钮固定在页面底部。这样做也是可以的，但是缺点在于，上半部分使用了固定高度以后，对不同手机页面显示是有差异的，所以这样方案在某种程度上来说不可取。

(3) 方案3，类似于方案1，唯一不同点在于上半部分的高度可以通过calc(100vh - 40px);进行计算得到。这应该是最简单的实现方式了。社区里闲逛的时候无意间看到这种方法，百转千回一个calc计算就可以解决，默默流下了两行热泪



6、 开发过程中遇到的一些与网络相关的异常

异常：请求后端接口的时候，返回一片空白、返回500、返回404。小程序进入页面后点击没反应，感觉是页面好像卡死了

多数原因：需要连接VPN、nginx服务需要重启、configserver需要重启、连接的无线网断网了、后端服务没有正确启动

 

7、小程序第一次提审发布后，搜索进入到线上小程序，进入到页面后提示“请求失败”，后端获取不到前端发送的请求。

原因：在微信公众平台里要配置域名白名单，要配置这个小程序里边用到的所有域名

 

8、引入gulp、jenkins

