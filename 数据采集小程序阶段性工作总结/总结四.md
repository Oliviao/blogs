1、 位置采集
需求：扫码后页面开始倒计时30秒，30秒内能够上报用户位置20次

实现方式：

    使用定时器 setInterval( function(){}, 1000) 成为该页面的定时系统

存在问题：

ios系统上setInterval( function(){}, 1000)  并不是每隔一秒就执行一次，而是计时跑的飞快，看起来像一秒执行了两三次。
小程序挂起或息屏状态下几秒钟后，计时器开始执行缓慢或者不执行了，安卓和ios上都有这个问题
解决方案：

    既然依赖 setInterval( function(){}, 1000)  每秒执行一次并不准确，那么就纯粹把它当成一个for 循环来使用，至少它能能保证每隔一段未知时间就执行一次里面的函数。在计时器的函数体里面，通过new Date().getTime() - startTime来准确判断当前时间过了几秒钟，控制界面显示，也控制一秒最多只能调用regeo获取一次用户位置(该接口规定)

 

2、 优化：上报多张图片



之前采用的上报流程：

用户点击“确认上报”，然后9张图片一张一张上传到腾讯云，前端拿到了这9张图片的链接之后，连同其他数据一起发送给后端
缺点：

上报数据过程缓慢，如果用户只上传了一两张图片，整个过程持续两三秒还可以接受。但是图片数量>=3张的时候，整个上报过程将持续5s~13s之间，用户体验比较差
优化方法：

在小程序中使用canvas将用户上传的图片合成为一张图片，然后再上报该图片。这样不管用户上传了几张图片，都会被绘制到一张大图上进行上报存储。在图片合成上报过程中应尽可能保证图片的清晰度，为日后运营人员查看分析使用。
优化后的最大优点：

用户上报数据的过程瞬间变快，不管用户上传了几张照片，都能都保证点击“确认上报”之后，能够立马上报成功，其间不超过1秒。
保证了图片的清晰度
对图片大小进行了大幅度压缩，大大减少图片存储所占据的空间。我们都知道，现在的手机随便拍一张照片就会达到几M甚至十几M，使用canvas压缩后的图片大小将以k来表达
 

3、优化：围栏列表展示、围栏的新增、删除

现存问题：前端一次性展示围栏过多会出现页面卡顿的情况

最佳方案：

控制一次向用户展示的围栏数量
控制方法：提醒用户把地图缩放到一定比例之后，将当前界面的4个角的经纬度发送给后端，后端只返回当前显示界面的围栏。同样，当用户拖拽、缩放、移动位置的时候，重新向后端发送数据请求新的围栏列表